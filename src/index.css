@tailwind base;
@tailwind components;
@tailwind utilities;

/* CSS Custom Properties for Theme System */
:root {
  --color-primary: #000000;
  --color-secondary: #111111;
  --color-accent-1: #dd0000;
  --color-accent-2: #fc5c12;
  --color-text: #ffffff;
  --color-text-secondary: #a1a1aa;
  --color-border: #374151;
}

/* Custom global styles */
@layer base {
  * {
    box-sizing: border-box;
  }
  
  html {
    scroll-behavior: smooth;
  }
  
  body {
    margin: 0;
    padding: 0;
    background-color: var(--color-primary);
    color: var(--color-text);
    font-family: 'IBM Plex Sans JP', sans-serif;
    overflow-x: hidden;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  
  @font-face {
    font-family: 'MantouSans-Regular';
    src: url('fonts/MantouSans-Regular.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Dela Gothic One', cursive;
    text-transform: uppercase;
  }
}

/* Delete arrow from input type number */
@layer utilities {
  .text-stroke {
    -webkit-text-stroke: 1px rgba(255, 255, 255, 0.5);
  }
} 

input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Delete arrow from input type number Firefox */
input[type=number] {
  -moz-appearance: textfield;
}

/* Custom Scrollbar Styling - Theme Aware */
:root {
  --scrollbar-width: 6px;
  --scrollbar-track: rgba(0, 0, 0, 0.1);
  --scrollbar-thumb: rgba(255, 255, 255, 0.15);
  --scrollbar-thumb-hover: rgba(255, 255, 255, 0.3);
  --scrollbar-thumb-active: rgba(255, 255, 255, 0.4);
}

/* Webkit Scrollbars (Chrome, Safari, Edge) */
::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
}

::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
  border-radius: calc(var(--scrollbar-width) / 2);
}

::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: calc(var(--scrollbar-width) / 2);
  transition: all 0.3s ease;
  opacity: 0.7;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--scrollbar-thumb-hover);
  opacity: 1;
  transform: scaleY(1.1);
}

::-webkit-scrollbar-thumb:active {
  background: var(--scrollbar-thumb-active);
  opacity: 1;
}

::-webkit-scrollbar-corner {
  background: var(--scrollbar-track);
}

/* Auto-hide scrollbar */
::-webkit-scrollbar {
  opacity: 0;
  transition: opacity 0.3s ease;
}

*:hover::-webkit-scrollbar {
  opacity: 1;
}

/* Firefox scrollbar */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}

/* Enhanced smooth scrolling */
html {
  scroll-behavior: smooth;
  scroll-padding-top: 2rem;
}

/* Smooth scrolling for all scrollable elements */
* {
  scroll-behavior: smooth;
}

/* Custom scrollable areas */
.custom-scroll {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb) transparent;
}

.custom-scroll::-webkit-scrollbar {
  width: var(--scrollbar-width);
  opacity: 1;
}

.custom-scroll::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scroll::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: calc(var(--scrollbar-width) / 2);
  transition: all 0.2s ease;
}

.custom-scroll::-webkit-scrollbar-thumb:hover {
  background: var(--scrollbar-thumb-hover);
}

/* Thin scrollbar variant */
.thin-scroll::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}

.thin-scroll {
  scrollbar-width: thin;
}

/* Smooth scroll animations */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
}

/* ===== ACCESSIBILITY STYLES ===== */

/* Screen reader only content */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Show screen reader content when focused */
.sr-only:focus,
.focus\:not-sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* Skip links */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--color-accent-1);
  color: white;
  padding: 8px 16px;
  text-decoration: none;
  border-radius: 4px;
  z-index: 1000;
  font-weight: 600;
  transition: top 0.3s ease;
}

.skip-link:focus {
  top: 6px;
}

/* Enhanced focus indicators */
.focus-visible *:focus-visible,
.focus-visible *:focus {
  outline: 2px solid var(--color-accent-1);
  outline-offset: 2px;
  border-radius: 4px;
}

/* Keyboard navigation mode */
.keyboard-navigation *:focus {
  outline: 2px solid var(--color-accent-1);
  outline-offset: 2px;
}

/* High contrast mode */
.high-contrast {
  --color-primary: #000000;
  --color-secondary: #000000;
  --color-accent-1: #ff0000;
  --color-accent-2: #ff6600;
  --color-text: #ffffff;
  --color-text-secondary: #ffffff;
  --color-border: #ffffff;
}

.high-contrast * {
  border-color: var(--color-border) !important;
}

.high-contrast button,
.high-contrast input,
.high-contrast select,
.high-contrast textarea {
  border: 2px solid var(--color-border) !important;
  background-color: var(--color-primary) !important;
  color: var(--color-text) !important;
}

.high-contrast a {
  color: var(--color-accent-1) !important;
  text-decoration: underline !important;
}

.high-contrast .text-gray-400,
.high-contrast .text-gray-300 {
  color: var(--color-text) !important;
}

/* Large text mode */
.large-text {
  font-size: 1.125rem;
}

.large-text h1 { font-size: 3.5rem; }
.large-text h2 { font-size: 2.5rem; }
.large-text h3 { font-size: 2rem; }
.large-text h4 { font-size: 1.75rem; }
.large-text h5 { font-size: 1.5rem; }
.large-text h6 { font-size: 1.25rem; }

.large-text .text-xs { font-size: 0.875rem; }
.large-text .text-sm { font-size: 1rem; }
.large-text .text-base { font-size: 1.25rem; }
.large-text .text-lg { font-size: 1.5rem; }
.large-text .text-xl { font-size: 1.75rem; }
.large-text .text-2xl { font-size: 2rem; }
.large-text .text-3xl { font-size: 2.5rem; }

/* Reduced motion */
.reduce-motion *,
.reduce-motion *::before,
.reduce-motion *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
  transform: none !important;
}

/* Disable Framer Motion animations when reduced motion is enabled */
.reduce-motion [data-framer-motion] {
  transform: none !important;
  opacity: 1 !important;
}

/* Ensure immediate visibility for reduced motion */
.reduce-motion .animate-spin {
  animation: none !important;
}

.reduce-motion .animate-pulse {
  animation: none !important;
}

/* Screen reader mode optimizations */
.screen-reader-mode {
  /* Ensure all interactive elements are properly labeled */
}

.screen-reader-mode button:not([aria-label]):not([aria-labelledby]) {
  position: relative;
}

.screen-reader-mode button:not([aria-label]):not([aria-labelledby])::after {
  content: "Button";
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* Focus management */
.focus-trap {
  position: relative;
}

/* Improved button accessibility */
button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

button[aria-pressed="true"] {
  background-color: var(--color-accent-1);
  color: white;
}

/* Form accessibility */
input:invalid,
textarea:invalid,
select:invalid {
  border-color: #ef4444;
  box-shadow: 0 0 0 1px #ef4444;
}

input[aria-invalid="true"],
textarea[aria-invalid="true"],
select[aria-invalid="true"] {
  border-color: #ef4444;
  box-shadow: 0 0 0 1px #ef4444;
}

/* Error messages */
.error-message {
  color: #ef4444;
  font-size: 0.875rem;
  margin-top: 0.25rem;
}

/* Loading states */
.loading {
  position: relative;
  pointer-events: none;
}

.loading::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin: -10px 0 0 -10px;
  border: 2px solid var(--color-accent-1);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* Respect user's motion preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* High contrast media query support */
@media (prefers-contrast: high) {
  :root {
    --color-accent-1: #ff0000;
    --color-accent-2: #ff6600;
    --color-text: #ffffff;
    --color-text-secondary: #ffffff;
    --color-border: #ffffff;
  }
}

/* Color contrast improvements for WCAG AA compliance */
.text-gray-400 {
  color: #9ca3af; /* Improved from original for better contrast */
}

.text-gray-300 {
  color: #d1d5db; /* Improved contrast ratio */
}

/* Ensure interactive elements meet minimum size requirements (44px) */
button,
input[type="button"],
input[type="submit"],
input[type="reset"],
a[role="button"] {
  min-height: 44px;
  min-width: 44px;
}

/* Touch target improvements for mobile */
@media (pointer: coarse) {
  button,
  input[type="button"],
  input[type="submit"],
  input[type="reset"],
  a[role="button"] {
    min-height: 48px;
    min-width: 48px;
  }
}

/* Mobile-specific improvements */
@media (max-width: 768px) {
  /* Ensure proper viewport handling */
  html {
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%;
  }
  
  /* Improve touch scrolling */
  * {
    -webkit-overflow-scrolling: touch;
  }
  
  /* Better mobile form inputs */
  input, textarea, select {
    font-size: 16px; /* Prevents zoom on iOS */
  }
  
  /* Mobile-friendly spacing */
  .mobile-padding {
    padding-left: 1rem;
    padding-right: 1rem;
  }
  
  /* Ensure buttons are touch-friendly */
  button {
    min-height: 44px;
    padding: 0.75rem 1rem;
  }
  
  /* Better mobile text sizing */
  .mobile-text-sm {
    font-size: 0.875rem;
    line-height: 1.25rem;
  }
  
  /* Mobile-specific grid adjustments */
  .mobile-grid-1 {
    grid-template-columns: repeat(1, minmax(0, 1fr));
  }
}

/* Line clamp utility */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.line-clamp-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Touch manipulation for better mobile interaction */
.touch-manipulation {
  touch-action: manipulation;
}

/* Mobile viewport fixes */
@media screen and (max-width: 768px) {
  /* Prevent horizontal scrolling */
  body {
    overflow-x: hidden;
  }
  
  /* Better mobile button sizing */
  button, .btn {
    min-height: 44px;
    min-width: 44px;
    touch-action: manipulation;
  }
  
  /* Mobile-friendly input sizing */
  input, textarea, select {
    min-height: 44px;
    font-size: 16px; /* Prevents zoom on iOS */
  }
  
  /* Better mobile spacing */
  .mobile-container {
    padding-left: 1rem;
    padding-right: 1rem;
  }
  
  /* Mobile-specific text sizes */
  .mobile-text-xs { font-size: 0.75rem; }
  .mobile-text-sm { font-size: 0.875rem; }
  .mobile-text-base { font-size: 1rem; }
  .mobile-text-lg { font-size: 1.125rem; }
  
  /* Ensure proper stacking on mobile */
  .mobile-stack {
    flex-direction: column;
  }
  
  /* Mobile-friendly grid */
  .mobile-grid-1 {
    grid-template-columns: 1fr;
  }
  
  .mobile-grid-2 {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Landscape mobile adjustments */
@media screen and (max-height: 500px) and (orientation: landscape) {
  /* Reduce vertical spacing in landscape */
  .landscape-compact {
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }
}

/* Prevent text overflow on mobile */
@media screen and (max-width: 768px) {
  /* Ensure text doesn't overflow containers */
  .prose, .prose * {
    max-width: 100% !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }
  
  /* Prevent horizontal scrolling in preview */
  .prose pre {
    overflow-x: auto;
    white-space: pre-wrap;
    word-break: break-all;
  }
  
  /* Better mobile code blocks */
  .prose code {
    word-break: break-all;
    white-space: pre-wrap;
  }
  
  /* Mobile-friendly tables */
  .prose table {
    display: block;
    overflow-x: auto;
    white-space: nowrap;
  }
  
  /* Ensure images don't overflow */
  .prose img {
    max-width: 100%;
    height: auto;
  }
}

/* Custom slider styles */
.slider::-webkit-slider-thumb {
  appearance: none;
  height: 20px;
  width: 20px;
  border-radius: 50%;
  background: var(--color-accent-1);
  cursor: pointer;
  border: 2px solid var(--color-accent-1);
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
}

.slider::-webkit-slider-thumb:hover {
  background: var(--color-accent-2);
  border-color: var(--color-accent-2);
}

.slider::-moz-range-thumb {
  height: 20px;
  width: 20px;
  border-radius: 50%;
  background: var(--color-accent-1);
  cursor: pointer;
  border: 2px solid var(--color-accent-1);
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
}

.slider::-moz-range-thumb:hover {
  background: var(--color-accent-2);
  border-color: var(--color-accent-2);
}

.slider::-webkit-slider-track {
  background: #374151;
  border-radius: 5px;
}

.slider::-moz-range-track {
  background: #374151;
  border-radius: 5px;
}