import{r as e,j as t}from"./react-vendor-BlsGRQ4b.js";import{e as s,k as r,a}from"./utils-CY6uHEMy.js";import{m as n,A as o}from"./motion-SEeoIC92.js";const i=()=>{const[i,l]=e.useState([]),[c,d]=e.useState(""),[h,u]=e.useState(null),[x,g]=e.useState(""),[m,p]=e.useState(!1),[f,b]=e.useState(!0),[j,v]=e.useState(!1),[y,w]=e.useState(!1),[k,N]=e.useState(null),[C,L]=e.useState(!1),[S,$]=e.useState(!0),M=e.useRef(null),B=e.useRef(null);e.useEffect(()=>{(async()=>{try{const e=await s.get("personal_notes",{fallbackToBackup:!0,password:void 0}),t=await s.get("notes_settings",{fallbackToBackup:!0});e&&(l(e),e.length>0&&(u(e[0].id),d(e[0].content))),t&&($(!1!==t.autoSave),b(!1!==t.showToolbar))}catch(e){}})()},[]);const W=e.useCallback(async()=>{try{const e={autoSave:S,showToolbar:f};await s.set("notes_settings",e,{backup:!0})}catch(e){}},[S,f]);e.useEffect(()=>{W()},[W]);const A=e.useCallback(async e=>{if(S){L(!0);try{await s.set("personal_notes",e,{backup:!0}),N(new Date)}catch(t){}finally{L(!1)}}},[S]);e.useEffect(()=>(B.current&&clearTimeout(B.current),B.current=setTimeout(()=>{i.length>0&&A(i)},1e3),()=>{B.current&&clearTimeout(B.current)}),[i,A]);const D=()=>{const e={id:Date.now().toString(),title:"New Note",content:"",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},t=[e,...i];l(t),u(e.id),d(""),setTimeout(()=>{var e;null==(e=M.current)||e.focus()},100)},H=e=>{if(d(e),h){const t=i.map(t=>{if(t.id===h){const s=T(e)||"Untitled Note";return{...t,title:s,content:e,updatedAt:(new Date).toISOString()}}return t});l(t)}},T=e=>{if(!e.trim())return"";const t=e.split("\n")[0].trim().replace(/^#+\s*/,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1");return t.length>50?t.substring(0,50)+"...":t},z=e=>{const t=i.find(t=>t.id===e);t&&(u(e),d(t.content))},_=i.filter(e=>!x||e.title.toLowerCase().includes(x.toLowerCase())||e.content.toLowerCase().includes(x.toLowerCase())),I=e=>{const t=M.current;if(!t)return;const s=t.selectionStart,r=t.selectionEnd,a=c.substring(s,r);let n="",o=0;switch(e){case"bold":n=`**${a}**`,o=a?0:2;break;case"italic":n=`*${a}*`,o=a?0:1;break;case"heading":n=`## ${a}`,o=a?0:3;break;case"list":n=`- ${a}`,o=a?0:2;break;case"code":n=`\`${a}\``,o=a?0:1;break;case"link":n=`[${a}](url)`,o=a?-4:-5;break;default:return}const i=c.substring(0,s)+n+c.substring(r);H(i),setTimeout(()=>{const e=s+n.length+o;t.setSelectionRange(e,e),t.focus()},0)},E=e=>{const t=new Date(e),s=new Date-t,r=Math.floor(s/6e4),a=Math.floor(s/36e5),n=Math.floor(s/864e5);return r<1?"Just now":r<60?`${r}m ago`:a<24?`${a}h ago`:n<7?`${n}d ago`:t.toLocaleDateString()};return t.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-gray-900/50 border border-gray-700 rounded-xl p-6 backdrop-blur-sm w-full max-w-7xl mx-auto",role:"application","aria-label":"Notes application",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 text-accent-1",children:t.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"w-full h-full",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-semibold text-white",children:"Notes"}),t.jsxs("p",{className:"text-gray-400",children:[i.length," ",1===i.length?"note":"notes",k&&t.jsxs("span",{className:"ml-2",children:["• Saved ",E(k)]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[C&&t.jsx("div",{className:"w-5 h-5 border-2 border-accent-1/30 border-t-accent-1 rounded-full animate-spin"}),t.jsx("button",{onClick:()=>p(!m),className:"p-2 text-gray-400 hover:text-white transition-colors focus:outline-none focus:ring-2 focus:ring-accent-1 rounded","aria-label":m?"Hide search":"Show search","aria-expanded":m,"aria-controls":"notes-search",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),t.jsx("button",{onClick:()=>v(!j),className:"p-2 text-gray-400 hover:text-white transition-colors focus:outline-none focus:ring-2 focus:ring-accent-1 rounded","aria-label":j?"Hide settings":"Show settings","aria-expanded":j,"aria-controls":"notes-settings",children:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),t.jsx(o,{children:m&&t.jsxs(n.div,{id:"notes-search",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6",children:[t.jsx("label",{htmlFor:"search-input",className:"sr-only",children:"Search notes"}),t.jsx("input",{id:"search-input",type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"Search notes...",className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-accent-1 focus:ring-2 focus:ring-accent-1/20 transition-all duration-300","data-search-input":!0})]})}),t.jsxs("div",{className:"flex gap-6 h-[600px]",children:[t.jsxs("div",{className:"w-80 border-r border-gray-700 pr-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-medium text-white",children:"All Notes"}),t.jsx("button",{onClick:D,className:"px-3 py-1 bg-accent-1 hover:bg-accent-2 text-white text-sm rounded transition-colors focus:outline-none focus:ring-2 focus:ring-accent-1 focus:ring-offset-2 focus:ring-offset-gray-900","aria-label":"Create new note",children:"New Note"})]}),t.jsx("div",{className:"space-y-3 overflow-y-auto h-full",role:"listbox","aria-label":"Notes list",children:0===_.length?t.jsxs("div",{className:"text-center py-12",role:"status",children:[t.jsx("p",{className:"text-gray-400 mb-4",children:x?"No notes found":"No notes yet"}),!x&&t.jsx("button",{onClick:D,className:"text-accent-1 hover:text-accent-2 transition-colors focus:outline-none focus:ring-2 focus:ring-accent-1 rounded","aria-label":"Create your first note",children:"Create your first note"})]}):_.map((e,s)=>t.jsx("div",{onClick:()=>z(e.id),onKeyDown:t=>r.handleActivation(t,()=>z(e.id)),className:"p-4 rounded-lg cursor-pointer transition-colors group focus:outline-none focus:ring-2 focus:ring-accent-1 "+(h===e.id?"bg-accent-1/20 border border-accent-1/30":"bg-gray-800/30 hover:bg-gray-800/50"),role:"option","aria-selected":h===e.id,tabIndex:0,"aria-label":`Note: ${e.title}, updated ${E(e.updatedAt)}`,children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"text-white font-medium truncate mb-1",children:e.title}),t.jsxs("p",{className:"text-gray-400 text-sm line-clamp-2 mb-2",children:[e.content.replace(/[#*`[\]]/g,"").substring(0,80),e.content.length>80?"...":""]}),t.jsx("p",{className:"text-gray-500 text-xs",children:E(e.updatedAt)})]}),t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=i.filter(t=>t.id!==e);l(t),h===e&&(t.length>0?(u(t[0].id),d(t[0].content)):(u(null),d("")))})(e.id),a.announce(`Note "${e.title}" deleted`)},className:"opacity-0 group-hover:opacity-100 focus:opacity-100 p-1 text-red-400 hover:text-red-300 transition-all ml-2 focus:outline-none focus:ring-2 focus:ring-red-500 rounded","aria-label":`Delete note: ${e.title}`,children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})},e.id))})]}),t.jsxs("div",{className:"flex-1 flex flex-col",children:[f&&t.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>I("bold"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800/50 rounded transition-colors",title:"Bold",children:t.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 4h8a4 4 0 014 4 4 4 0 01-4 4H6z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 12h9a4 4 0 014 4 4 4 0 01-4 4H6z"})]})}),t.jsx("button",{onClick:()=>I("italic"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800/50 rounded transition-colors",title:"Italic",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 4l4 16M6 8h12M4 16h12"})})}),t.jsx("button",{onClick:()=>I("heading"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800/50 rounded transition-colors",title:"Heading",children:t.jsx("span",{className:"text-lg font-bold",children:"H"})}),t.jsx("button",{onClick:()=>I("list"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800/50 rounded transition-colors",title:"List",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),t.jsx("button",{onClick:()=>I("code"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800/50 rounded transition-colors",title:"Code",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})})}),t.jsx("button",{onClick:()=>I("link"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800/50 rounded transition-colors",title:"Link",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]}),t.jsx("button",{onClick:()=>w(!y),className:"px-3 py-1 rounded transition-colors "+(y?"bg-accent-1 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:y?"Edit":"Preview"})]}),y?t.jsx("div",{className:"flex-1 p-6 bg-gray-800/30 rounded-lg overflow-y-auto text-gray-300 leading-relaxed prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:(O=c,O.replace(/^# (.*$)/gm,'<h1 class="text-2xl font-bold text-white mb-4">$1</h1>').replace(/^## (.*$)/gm,'<h2 class="text-xl font-semibold text-white mb-3">$1</h2>').replace(/^### (.*$)/gm,'<h3 class="text-lg font-medium text-white mb-2">$1</h3>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold text-white">$1</strong>').replace(/\*(.*?)\*/g,'<em class="italic text-gray-300">$1</em>').replace(/`(.*?)`/g,'<code class="bg-gray-800 px-2 py-1 rounded text-accent-1 font-mono text-sm">$1</code>').replace(/^- (.*$)/gm,'<li class="text-gray-300 ml-4 mb-1">• $1</li>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" class="text-accent-1 hover:text-accent-2 underline" target="_blank">$1</a>').replace(/\n/g,"<br>"))}}):t.jsx("textarea",{ref:M,value:c,onChange:e=>H(e.target.value),placeholder:h?"Start writing your note... Use markdown for formatting!":"Create a new note to get started",className:"flex-1 w-full p-6 bg-gray-800/30 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-accent-1 focus:ring-2 focus:ring-accent-1/20 transition-all duration-300 resize-none font-mono text-sm leading-relaxed",disabled:!h}),t.jsx("div",{className:"mt-4 text-xs text-gray-500",children:t.jsxs("details",{className:"cursor-pointer",children:[t.jsx("summary",{className:"hover:text-gray-400 transition-colors",children:"Markdown formatting help"}),t.jsxs("div",{className:"mt-3 grid grid-cols-3 gap-4 p-4 bg-gray-800/30 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("code",{children:"**bold**"})," → ",t.jsx("strong",{children:"bold"})]}),t.jsxs("div",{children:[t.jsx("code",{children:"*italic*"})," → ",t.jsx("em",{children:"italic"})]}),t.jsxs("div",{children:[t.jsx("code",{children:"## heading"})," → heading"]}),t.jsxs("div",{children:[t.jsx("code",{children:"- list item"})," → • list item"]}),t.jsxs("div",{children:[t.jsx("code",{children:"`code`"})," → ",t.jsx("code",{children:"code"})]}),t.jsxs("div",{children:[t.jsx("code",{children:"[link](url)"})," → link"]})]})]})})]})]}),t.jsx(o,{children:j&&t.jsx(n.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-6 pt-6 border-t border-gray-700",children:t.jsx("div",{className:"flex items-center justify-between",children:t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs("label",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:S,onChange:e=>$(e.target.checked),className:"w-4 h-4 text-accent-1 bg-gray-700 border-gray-600 rounded focus:ring-accent-1 focus:ring-2"}),t.jsx("span",{className:"text-sm text-gray-400",children:"Auto-save notes"})]}),t.jsxs("label",{className:"flex items-center gap-3",children:[t.jsx("input",{type:"checkbox",checked:f,onChange:e=>b(e.target.checked),className:"w-4 h-4 text-accent-1 bg-gray-700 border-gray-600 rounded focus:ring-accent-1 focus:ring-2"}),t.jsx("span",{className:"text-sm text-gray-400",children:"Show formatting toolbar"})]})]})})})})})]});var O};export{i as N};
